<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to ino • ino</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ino">
<meta name="description" content="How to get started with ino
">
<meta property="og:description" content="How to get started with ino
">
<meta property="og:image" content="https://loelschlaeger.de/ino/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ino</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ino.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/loelschlaeger/ino/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to ino</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/loelschlaeger/ino/blob/master/vignettes/ino.Rmd" class="external-link"><code>vignettes/ino.Rmd</code></a></small>
      <div class="d-none name"><code>ino.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>Optimization aims to maximize effectiveness, efficiency, or
functionality in various fields. Examples include portfolio selection in
finance, minimizing air resistance in engineering, or likelihood
maximization in statistical modeling. The common goal is to find inputs
that produce an optimal output.</p>
<p>In some scenarios, determining optimality is feasible by analytical
means, for example with simple objective functions like
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>:</mo><mi>ℝ</mi><mo>→</mo><mi>ℝ</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">f:\mathbb{R} \to \mathbb{R},\ f(x) = -x^2</annotation></semantics></math>.
The first derivative
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>′</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mn>2</mn><mi>x</mi></mrow><annotation encoding="application/x-tex">f'(x) = -2x</annotation></semantics></math>
vanishes at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x = 0</annotation></semantics></math>,
and since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
is strictly concave, we conclude that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x = 0</annotation></semantics></math>
is the unique point where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math>
is maximal. However, many optimization problems lack closed-form
solutions, requiring <strong>numerical optimization</strong>.</p>
<p>Numerical optimization encompasses algorithms that iteratively
explore the parameter space, seeking improvement in the function output
with each iteration and ultimately converging to a point where further
improvements are not possible <span class="citation">(<a href="#ref-Bonnans:2006">Bonnans et al. 2006</a>)</span>. R offers
various implementations of such algorithms<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The CRAN Task View: Optimization and Mathematical
Programming &lt;span class="citation"&gt;(&lt;a href="#ref-Schwendinger:2023"&gt;Schwendinger and Borchers 2023&lt;/a&gt;)&lt;/span&gt;
provides an exhaustive list of packages for numerical optimization.&lt;/p&gt;'><sup>1</sup></a>. Common to all these
algorithms is the necessity to specify <strong>initial parameter
values</strong>.</p>
<p>Crucially, initialization can strongly influence optimization time
and outcomes <span class="citation">(<a href="#ref-Nocedal:2006">Nocedal
and Wright 2006</a>)</span>. Starting in non-concave areas risks
convergence issues or settling on local optima instead of the global
optimum, while starting in flat regions can slow computation, which is
especially critical when function evaluations are costly. This raises
two key questions:</p>
<ol style="list-style-type: decimal">
<li><p>Does initialization affect my optimization problem?</p></li>
<li><p>If so, what initial values ensure fast optimization leading to
the global optimum?</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="package-functionality">Package functionality<a class="anchor" aria-label="anchor" href="#package-functionality"></a>
</h2>
<p>We introduce <a href="https://loelschlaeger.de/ino/">ino</a>, short for <strong>initialization of
numerical optimization</strong>, designed to address the aforementioned
questions:</p>
<ol style="list-style-type: decimal">
<li><p>Investigation into the impact of initial values on
optimization.</p></li>
<li><p>Comparison of various initialization strategies.</p></li>
<li><p>Comparison of different numerical optimizers.</p></li>
</ol>
<p>Following an <strong>object-oriented approach</strong><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;We utilize the framework of the &lt;a href="https://r6.r-lib.org" class="external-link"&gt;R6&lt;/a&gt;
package &lt;span class="citation"&gt;(&lt;a href="#ref-Chang:2025"&gt;Chang
2025&lt;/a&gt;)&lt;/span&gt;.&lt;/p&gt;'><sup>2</sup></a>, the package treats
numerical optimization problems as objects. These objects are defined by
a real-valued function, its target arguments, and one or more
optimization algorithms. The object provides methods for selecting
initial values, executing numerical minimization or maximization, and
evaluating the optimization results.</p>
<p>The key advantages of using the <a href="https://loelschlaeger.de/ino/">ino</a> package
include:</p>
<ul>
<li><p>Straightforward comparisons among optimizers and initialization
strategies.</p></li>
<li><p>Compatibility with any optimizer implemented in R for both
minimization and maximization tasks through the <a href="https://loelschlaeger.de/optimizeR/" class="external-link">optimizeR</a>
framework <span class="citation">(<a href="#ref-Oelschlaeger:2025">Oelschläger and Ötting 2025</a>)</span>,
detailed below.</p></li>
<li><p>Support for parallel computation through the
<a href="https://future.futureverse.org" class="external-link">future</a> package <span class="citation">(<a href="#ref-Bengtsson:2021">Bengtsson 2021</a>)</span> and progress
updates via the <a href="https://progressr.futureverse.org" class="external-link">progressr</a> package <span class="citation">(<a href="#ref-Bengtsson:2024">Bengtsson
2024</a>)</span>.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="example-workflow">Example workflow<a class="anchor" aria-label="anchor" href="#example-workflow"></a>
</h2>
<p>To begin, obtain <a href="https://loelschlaeger.de/ino/">ino</a> from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> via:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ino"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://loelschlaeger.de/ino/">"ino"</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="gaussian-mixture-model">Gaussian mixture model<a class="anchor" aria-label="anchor" href="#gaussian-mixture-model"></a>
</h3>
<p>In this example, the function to be optimized is a likelihood
function, computing the probability of observing given data under a
specified model assumption. The parameters that maximize this likelihood
function are identified as the model estimates. This method, known as <a href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation" class="external-link">maximum
likelihood estimation</a>, is widely used in statistics for fitting
models to empirical data.</p>
<p>We examine eruption times of the Old Faithful geyser in Yellowstone
National Park, Wyoming, USA. The data histogram suggests two clusters
with short and long eruption times, respectively:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">eruptions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"eruption time (min)"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="figures/ino-faithful-plot-1.png" width="75%" style="display: block; margin: auto;"></p>
<p>For both clusters, we assume a normal distribution, representing a
mixture of two Gaussian densities to model the overall eruption times.
The log-likelihood function<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Optimizing the log-likelihood function is equivalent to
optimizing the likelihood function, as likelihoods are non-negative and
the logarithm is a monotone transformation. However, optimizing the
log-likelihood function has numerical advantages, particularly in
avoiding numerical underflow when the likelihood becomes small.&lt;/p&gt;"><sup>3</sup></a> is defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>log</mo><mo minsize="1.8" maxsize="1.8" stretchy="false" form="prefix">(</mo><mi>λ</mi><msub><mi>ϕ</mi><mrow><msub><mi>μ</mi><mn>1</mn></msub><mo>,</mo><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ϕ</mi><mrow><msub><mi>μ</mi><mn>2</mn></msub><mo>,</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.8" maxsize="1.8" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
\ell(\boldsymbol{\theta}) = \sum_{i=1}^n \log\Big( \lambda \phi_{\mu_1, \sigma_1^2}(x_i) + (1-\lambda)\phi_{\mu_2,\sigma_2^2} (x_i) \Big)
</annotation></semantics></math></p>
<p>Here, the sum covers all observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi><mo>=</mo><mn>272</mn></mrow><annotation encoding="application/x-tex">1, \dots, n = 272</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mrow><msub><mi>μ</mi><mn>1</mn></msub><mo>,</mo><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup></mrow></msub><annotation encoding="application/x-tex">\phi_{\mu_1, \sigma_1^2}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mrow><msub><mi>μ</mi><mn>2</mn></msub><mo>,</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></msub><annotation encoding="application/x-tex">\phi_{\mu_2, \sigma_2^2}</annotation></semantics></math>
represent the normal density for the first and second cluster,
respectively, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is the mixing proportion.</p>
<p>Our objective is to find values for the parameter vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛉</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>μ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub><mo>,</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta} = (\mu_1, \mu_2, \sigma_1, \sigma_2, \lambda)</annotation></semantics></math>
that maximize
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ell(\boldsymbol{\theta})</annotation></semantics></math>.
Due to the complexity of the problem, analytical solutions are not
available, therefore numerical optimization is required.</p>
<blockquote>
<p><strong>Remark:</strong> Numerical optimization in this example is
fast due to the relatively small dataset and a model with only two
classes. While initialization might seem less critical in this scenario,
it becomes a more significant concern as the problem scales with more
data and parameters <span class="citation">(<a href="#ref-Shireman:2017">Shireman, Steinley, and Brusco
2017</a>)</span>. Furthermore, even this seemingly simple optimization
problem is susceptible to local optima, depending on the chosen initial
values, as we will see below.</p>
</blockquote>
<p>The following function computes the log-likelihood value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ell(\boldsymbol{\theta})</annotation></semantics></math>
given the parameters <code>mu</code>, <code>sigma</code>, and
<code>lambda</code> and the observation vector <code>data</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_mixture_llk</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span>, <span class="va">lambda</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">lambda</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">mu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">sigma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">lambda</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">mu</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">sigma</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">normal_mixture_llk</span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, sigma <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, lambda <span class="op">=</span> <span class="fl">5</span>, data <span class="op">=</span> <span class="va">faithful</span><span class="op">$</span><span class="va">eruptions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -1069.623</span></span></code></pre></div>
<blockquote>
<p><strong>Remark:</strong> To ensure positivity for the standard
deviations <code>sigma</code>, we apply the exponential transformation.
Similarly, to constrain <code>lambda</code> between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>,
we use the logit transformation. This approach allows us to optimize
over the value space
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℝ</mi><mn>5</mn></msup><annotation encoding="application/x-tex">\mathbb{R}^5</annotation></semantics></math>
without the need for box-constrained optimizers.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="initialization-effect">Initialization effect<a class="anchor" aria-label="anchor" href="#initialization-effect"></a>
</h3>
<p>Does the choice of initial values have an influence for this
optimization problem? In the following, we will use the
<a href="https://loelschlaeger.de/ino/">ino</a> package to optimize the likelihood function, starting
from 100 random initial points, and compare the results.</p>
<p>We start be defining the optimization problem:<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;For further details on the &lt;a href="https://r6.r-lib.org" class="external-link"&gt;R6&lt;/a&gt; syntax
employed by &lt;a href="https://loelschlaeger.de/ino/"&gt;ino&lt;/a&gt;, see &lt;span class="citation"&gt;Wickham (&lt;a href="#ref-Wickham:2019"&gt;2019&lt;/a&gt;)&lt;/span&gt;, Chapter 14.&lt;/p&gt;'><sup>4</sup></a></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Nop.html">Nop</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  f <span class="op">=</span> <span class="va">normal_mixture_llk</span>,               <span class="co"># the objective function</span></span>
<span>  target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"sigma"</span>, <span class="st">"lambda"</span><span class="op">)</span>,  <span class="co"># names of target arguments</span></span>
<span>  npar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,                    <span class="co"># lengths of target arguments</span></span>
<span>  data <span class="op">=</span> <span class="va">faithful</span><span class="op">$</span><span class="va">eruptions</span>             <span class="co"># values for fixed arguments</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The call <code>Nop$new()</code> creates a <code>Nop</code> object
that defines a numerical optimization problem. We have saved this object
with the name <code>Nop_mixture</code>. In the future, we can interact
with this object by invoking its methods using the syntax
<code>Nop_mixture$&lt;method name&gt;()</code> or its fields via
<code>Nop_mixture$&lt;field name&gt;</code>.</p>
<p>The arguments for creating <code>Nop_mixture</code> are:</p>
<ul>
<li>
<code>f</code>: the objective function to be optimized.</li>
<li>
<code>target</code>: the names of the target arguments over which
<code>objective</code> is optimized.</li>
<li>
<code>npar</code>: the length of each of these target
arguments.</li>
<li>The argument <code>data</code> is provided, which remains constant
during optimization.</li>
</ul>
<p>Additionally, analytical gradient and Hessian function for
<code>f</code> can be provided if available.</p>
<p>Once the <code>Nop</code> object is defined, the objective function
can be evaluated at a specific value <code>at</code> for the collapsed
target arguments:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span><span class="fu">evaluate</span><span class="op">(</span>at <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="co"># same values as above</span></span>
<span><span class="co">#&gt; [1] -1069.623</span></span></code></pre></div>
<p>Next, we require a numerical optimizer. Here, we choose
<code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">stats::nlm()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nlm</span> <span class="op">&lt;-</span> <span class="fu">optimizeR</span><span class="fu">::</span><span class="va"><a href="https://loelschlaeger.de/optimizeR/reference/Optimizer.html" class="external-link">Optimizer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>which <span class="op">=</span> <span class="st">"stats::nlm"</span><span class="op">)</span></span>
<span><span class="va">Nop_mixture</span><span class="op">$</span><span class="fu">set_optimizer</span><span class="op">(</span><span class="va">nlm</span><span class="op">)</span></span></code></pre></div>
<p>Once an optimizer is specified, the process of optimizing the
function becomes straightforward:</p>
<ol style="list-style-type: decimal">
<li>Define initial values using one of the <code>$initialize_*()</code>
methods (detailed below).</li>
<li>Call <code>$optimize()</code>.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Nop_mixture</span><span class="op">$</span></span>
<span>  <span class="fu">initialize_random</span><span class="op">(</span>runs <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">optimize</span><span class="op">(</span>which_direction <span class="op">=</span> <span class="st">"max"</span>, optimization_label <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></code></pre></div>
<p>The method <code>$initialize_random(runs = 20)</code> generates 20
sets of random initial values, with each set independently drawn from a
standard normal distribution by default. Subsequently,
<code>$optimize(which_direction = "max")</code> maximizes the function,
starting from these generated values. Setting an
<code>optimization_label</code> is optional but can be useful if
different initialization strategies are compared.</p>
<p>The optimization results can be accessed through the
<code>$results</code> field:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span><span class="va">results</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 13</span></span></span>
<span><span class="co">#&gt;    value parameter seconds initial error gradient  code iterations error_message</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.097<span style="text-decoration: underline;">0</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         36 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">276.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.115  <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         71 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.071<span style="text-decoration: underline;">3</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         43 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">276.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.040<span style="text-decoration: underline;">2</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         25 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.073<span style="text-decoration: underline;">4</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         48 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.091<span style="text-decoration: underline;">8</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         47 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.057<span style="text-decoration: underline;">9</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         38 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">276.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.052<span style="text-decoration: underline;">2</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         29 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">276.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.044<span style="text-decoration: underline;">5</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         28 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.061<span style="text-decoration: underline;">8</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         39 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.070<span style="text-decoration: underline;">1</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         45 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> -<span style="color: #BB0000;">276.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.049<span style="text-decoration: underline;">7</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         31 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> -<span style="color: #BB0000;">276.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.045<span style="text-decoration: underline;">0</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         28 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.068<span style="text-decoration: underline;">1</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         43 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.061<span style="text-decoration: underline;">3</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         40 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.063<span style="text-decoration: underline;">1</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         41 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.062<span style="text-decoration: underline;">9</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         42 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> -<span style="color: #BB0000;">276.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.084<span style="text-decoration: underline;">3</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         49 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> -<span style="color: #BB0000;">276.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.060<span style="text-decoration: underline;">5</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         40 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> -<span style="color: #BB0000;">421.</span> <span style="color: #949494;">&lt;dbl [5]&gt;</span>  0.065<span style="text-decoration: underline;">9</span> <span style="color: #949494;">&lt;dbl&gt;</span>   FALSE <span style="color: #949494;">&lt;dbl&gt;</span>        1         43 <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: .optimization_label &lt;chr&gt;, .optimizer_label &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   .direction &lt;chr&gt;, .original &lt;lgl&gt;</span></span></span></code></pre></div>
<p>In this <code>tibble</code>,</p>
<ul>
<li><p><code>value</code> and <code>parameter</code> are the
optimization results,</p></li>
<li><p><code>seconds</code> the elapsed optimization time in
seconds,</p></li>
<li><p><code>initial</code> the used initial values,</p></li>
<li><p><code>error</code> and <code>error_message</code> provide
information whether an error occurred,</p></li>
<li><p><code>gradient</code>, <code>code</code>, and
<code>iterations</code> are information provided by the
optimizer,</p></li>
<li><p><code>.optimization_label</code>, <code>.optimizer_label</code>,
<code>.direction</code>, and <code>.original</code> identify
optimization runs.</p></li>
</ul>
<p>For a quick overview, the <code>$optima()</code> method provides a
frequency table of the function values obtained at optimizer
convergence. You can choose to ignore decimal places using
<code>digits = 0</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span><span class="fu">optima</span><span class="op">(</span>which_direction <span class="op">=</span> <span class="st">"max"</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   value     n</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  -<span style="color: #BB0000;">421</span>    12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  -<span style="color: #BB0000;">276</span>     8</span></span></code></pre></div>
<p>The impact of initial values on the outcome is apparent. Now, we
might question the implications of the two maxima,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>276</mn></mrow><annotation encoding="application/x-tex">-276</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>421</mn></mrow><annotation encoding="application/x-tex">-421</annotation></semantics></math>,
for our Gaussian mixture model fit to the Geyser data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global</span> <span class="op">&lt;-</span> <span class="va">Nop_mixture</span><span class="op">$</span><span class="va">maximum</span><span class="op">$</span><span class="va">parameter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="va">local</span> <span class="op">&lt;-</span> <span class="va">Nop_mixture</span><span class="op">$</span><span class="va">results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">value</span> <span class="op">-</span> <span class="op">(</span><span class="op">-</span><span class="fl">421</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">parameter</span><span class="op">)</span> <span class="op">|&gt;</span>                       </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p>Two parameter vectors are stored as objects <code>global</code>
(presumably the global maximum) and <code>local</code> (a local
maximum). To interpret the parameter estimates in terms of mean,
standard deviation, and mixing proportion, i.e., in the form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛉</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>μ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>σ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>σ</mi><mn>2</mn></msub><mo>,</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta} = (\mu_1, \mu_2, \sigma_1, \sigma_2, \lambda)</annotation></semantics></math>,
back-transformation to the restricted parameter space
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ℝ</mi><mn>2</mn></msup><mo>×</mo><msubsup><mi>ℝ</mi><mo>+</mo><mn>2</mn></msubsup><mo>×</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{R}^2 \times \mathbb{R}_+^2 \times [0,1]</annotation></semantics></math>
is necessary (as mentioned above):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">transform</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">global</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">global</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.2733434 2.0186078 0.4370631 0.2356218 0.6515954</span></span>
<span><span class="op">(</span><span class="va">local</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">local</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.4877815 0.7821391 1.1392698 0.1367844 1.0000000</span></span></code></pre></div>
<p>The estimates <code>global</code> and <code>local</code> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛉</mi><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math>
correspond to the following mixture densities:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mixture_density</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">data</span>, <span class="va">mu</span>, <span class="va">sigma</span>, <span class="va">lambda</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">lambda</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">mu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">sigma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">lambda</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">mu</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">sigma</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">eruptions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"eruption time (min)"</span>, colour <span class="op">=</span> <span class="st">"parameter"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">mixture_density</span><span class="op">(</span><span class="va">x</span>, mu <span class="op">=</span> <span class="va">global</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, sigma <span class="op">=</span> <span class="va">global</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, lambda <span class="op">=</span> <span class="va">global</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"global"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">mixture_density</span><span class="op">(</span><span class="va">x</span>, mu <span class="op">=</span> <span class="va">local</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, sigma <span class="op">=</span> <span class="va">local</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, lambda <span class="op">=</span> <span class="va">local</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"local"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="figures/ino-estimated-mixtures-1.png" width="75%" style="display: block; margin: auto;"></p>
<p>It is evident that the mixture defined by the <code>global</code>
parameter fits much better than the <code>local</code>, which
essentially estimates only a single class.</p>
</div>
<div class="section level3">
<h3 id="comparing-initialization-strategies">Comparing initialization strategies<a class="anchor" aria-label="anchor" href="#comparing-initialization-strategies"></a>
</h3>
<p>Different initial values significantly impact the results of
numerical likelihood optimization for the mixture model, as demonstrated
so far. This prompts the question of how to optimally choose initial
values. The <a href="https://loelschlaeger.de/ino/">ino</a> package offers various initialization
methods that can be easily compared:</p>
<table class="table">
<colgroup>
<col width="18%">
<col width="81%">
</colgroup>
<thead><tr class="header">
<th>Method</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>$initialize_fixed()</code></td>
<td>Fixed initial values, for example at the origin or educated
guesses.</td>
</tr>
<tr class="even">
<td><code>$initialize_random()</code></td>
<td>Random initial values drawn from a custom distribution.</td>
</tr>
<tr class="odd">
<td><code>$initialize_grid()</code></td>
<td>Initial values as grid points, optionally randomly shuffled.</td>
</tr>
<tr class="even">
<td><code>$initialize_continue()</code></td>
<td>Initial values from previous optimization runs on a simplified
problem.</td>
</tr>
<tr class="odd">
<td><code>$initialize_custom()</code></td>
<td>Initial values based on a custom initialization strategy.</td>
</tr>
</tbody>
</table>
<p>To modify initial values, the following methods are available:</p>
<table class="table">
<colgroup>
<col width="18%">
<col width="81%">
</colgroup>
<thead><tr class="header">
<th>Method</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>$initialize_filter()</code></td>
<td>Filters initial values based on conditions.</td>
</tr>
<tr class="even">
<td><code>$initialize_promising()</code></td>
<td>Selects a proportion of promising initial values.</td>
</tr>
<tr class="odd">
<td><code>$initialize_transform()</code></td>
<td>Transforms the initial values.</td>
</tr>
<tr class="even">
<td><code>$initialize_reset()</code></td>
<td>Deletes all specified initial values.</td>
</tr>
</tbody>
</table>
<p>We previously applied the <code>$initialize_random()</code> method.
Next, we will compare it to <code>$initialize_grid()</code> in
combination with <code>$initialize_promising()</code>. Here, we make
“educated guesses” about starting values that are likely close to the
global optimum. Based on the histogram above, the means of the two
normal distributions may be around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>4</mn><annotation encoding="application/x-tex">4</annotation></semantics></math>.
We will use sets of starting values where the means are both around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>4</mn><annotation encoding="application/x-tex">4</annotation></semantics></math>,
respectively. For the variances, we set the starting values close to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
(note that we use the log-transformation here since we restrict the
standard deviations to be positive by using the exponential function in
the likelihood). The starting value for the mixing proportion shall be
around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.5</mn><annotation encoding="application/x-tex">0.5</annotation></semantics></math>.
We use three grid points in each dimension, which we shuffle via the
<code>jitter = TRUE</code> argument. This results in a grid of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>3</mn><mn>5</mn></msup><mo>=</mo><mn>243</mn></mrow><annotation encoding="application/x-tex">3^5 = 243</annotation></semantics></math>
starting values:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span><span class="fu">initialize_grid</span><span class="op">(</span></span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">3.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">qlogis</a></span><span class="op">(</span><span class="fl">0.4</span><span class="op">)</span><span class="op">)</span>, <span class="co"># lower bounds for the grid</span></span>
<span>  upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">4.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">qlogis</a></span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>, <span class="co"># upper bounds for the grid</span></span>
<span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,                            <span class="co"># breaks for the grid in each dimension</span></span>
<span>  jitter <span class="op">=</span> <span class="cn">TRUE</span>                                         <span class="co"># random shuffle of the grid points</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Out of the 243 grid starting values, we select a 10% proportion of
locations where the objective gradient is steepest and initiate
optimization from those points:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span></span>
<span>  <span class="fu">initialize_promising</span><span class="op">(</span>proportion <span class="op">=</span> <span class="fl">0.1</span>, condition <span class="op">=</span> <span class="st">"gradient_large"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">optimize</span><span class="op">(</span>which_direction <span class="op">=</span> <span class="st">"max"</span>, optimization_label <span class="op">=</span> <span class="st">"promising_grid"</span><span class="op">)</span></span></code></pre></div>
<p>It is evident that the initial values from the initialization
strategy concerning the steepest gradient more reliably lead to
convergence to the global maximum of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>276</mn></mrow><annotation encoding="application/x-tex">-276</annotation></semantics></math>
compared to random initial values:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span><span class="fu">optima</span><span class="op">(</span>which_direction <span class="op">=</span> <span class="st">"max"</span>, group_by <span class="op">=</span> <span class="st">"optimization"</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; $promising_grid</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">#&gt;   value     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  -<span style="color: #BB0000;">276</span>    25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $random</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   value     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  -<span style="color: #BB0000;">421</span>    12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  -<span style="color: #BB0000;">276</span>     8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "Nop_optima" "group_by"   "list"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparing-optimizer-functions">Comparing optimizer functions<a class="anchor" aria-label="anchor" href="#comparing-optimizer-functions"></a>
</h3>
<p>So far, we only utilized the <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">stats::nlm</a></code> optimizer,
employing a Newton-type algorithm. Now, we compare its results and
optimization time to:</p>
<ol style="list-style-type: decimal">
<li><p><code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code>, an alternative R optimizer that, by
default, applies the Nelder-Mead algorithm <span class="citation">(<a href="#ref-Nelder:1965">Nelder and Mead 1965</a>)</span>, and</p></li>
<li><p>The expectation-maximization algorithm <code>em_optimizer</code>,
an alternative optimization method for mixture models, which we define
in the appendix below.</p></li>
</ol>
<p>We will incorporate these two optimizers into our
<code>Nop_mixture</code> object using the <a href="https://loelschlaeger.de/optimizeR/" class="external-link">optimizeR</a>
framework (here, <code>em_optimizer</code> already is an optimizer in
the required framework):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">optim</span> <span class="op">&lt;-</span> <span class="fu">optimizeR</span><span class="fu">::</span><span class="va"><a href="https://loelschlaeger.de/optimizeR/reference/Optimizer.html" class="external-link">Optimizer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>which <span class="op">=</span> <span class="st">"stats::optim"</span><span class="op">)</span></span>
<span><span class="va">Nop_mixture</span><span class="op">$</span></span>
<span>  <span class="fu">set_optimizer</span><span class="op">(</span><span class="va">optim</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">set_optimizer</span><span class="op">(</span><span class="va">em_optimizer</span><span class="op">)</span></span></code></pre></div>
<p>Next, we initialize at 100 random points and optimize the mixture
likelihood with each of the three optimizers from these points:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span></span>
<span>  <span class="fu">initialize_random</span><span class="op">(</span>runs <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">optimize</span><span class="op">(</span>which_direction <span class="op">=</span> <span class="st">"max"</span>, optimization_label <span class="op">=</span> <span class="st">"optimizer_comparison"</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> method offers a visual comparison of the
(relative) optimization times:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span><span class="va">results</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.optimization_label</span> <span class="op">==</span> <span class="st">"optimizer_comparison"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span>which_element <span class="op">=</span> <span class="st">"seconds"</span>, group_by <span class="op">=</span> <span class="st">"optimizer"</span>, relative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      <span class="st">"x"</span> <span class="op">=</span> <span class="st">"optimization time relative to overall median"</span>,</span>
<span>      <span class="st">"y"</span> <span class="op">=</span> <span class="st">"optimizer"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="figures/ino-plot-seconds-1.png" width="75%" style="display: block; margin: auto;"></p>
<p>Among the three optimizers, the expectation-maximization algorithm is
evidently the fastest in this case. Moreover, it most frequently
converges to the value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>276</mn></mrow><annotation encoding="application/x-tex">-276</annotation></semantics></math>,
while <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> tends to converge to various local
optima. However, the expectation-maximization algorithm also encountered
failures in a couple of runs:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span><span class="fu">optima</span><span class="op">(</span>which_direction <span class="op">=</span> <span class="st">"max"</span>, group_by <span class="op">=</span> <span class="st">"optimizer"</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </span>
<span><span class="co">#&gt; $em</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   value     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  -<span style="color: #BB0000;">276</span>    83</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  -<span style="color: #BB0000;">421</span>    13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    <span style="color: #BB0000;">NA</span>     4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`stats::nlm`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   value     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  -<span style="color: #BB0000;">421</span>    92</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  -<span style="color: #BB0000;">276</span>    53</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`stats::optim`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 2</span></span></span>
<span><span class="co">#&gt;    value     n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  -<span style="color: #BB0000;">421</span>    65</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  -<span style="color: #BB0000;">276</span>     8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  -<span style="color: #BB0000;">278</span>     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  -<span style="color: #BB0000;">277</span>     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  -<span style="color: #BB0000;">293</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  -<span style="color: #BB0000;">453</span>     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  -<span style="color: #BB0000;">417</span>     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  -<span style="color: #BB0000;">416</span>     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  -<span style="color: #BB0000;">415</span>     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  -<span style="color: #BB0000;">403</span>     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "Nop_optima" "group_by"   "list"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-solution-to-the-optimization-problem">The solution to the optimization problem<a class="anchor" aria-label="anchor" href="#the-solution-to-the-optimization-problem"></a>
</h3>
<p>Finally, the best identified optimum can be extracted via:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span><span class="va">maximum</span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] -276.36</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $parameter</span></span>
<span><span class="co">#&gt; [1]  2.0186078  4.2733434 -1.4455274 -0.8276776 -0.6260592</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="verbose-mode">Verbose mode<a class="anchor" aria-label="anchor" href="#verbose-mode"></a>
</h3>
<p>The <a href="https://loelschlaeger.de/ino/">ino</a> package features a verbose mode, which prints
status messages and information during its usage. This mode is primarily
designed for new package users to provide feedback and hints about their
interactions with the package. Enabling or disabling the verbose mode
can be achieved by setting the <code>$verbose</code> field of a
<code>Nop</code> object to either <code>TRUE</code> or
<code>FALSE</code>. For example:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nop_mixture</span><span class="op">$</span><span class="va">verbose</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-expectation-maximization-algorithm">The expectation-maximization algorithm<a class="anchor" aria-label="anchor" href="#the-expectation-maximization-algorithm"></a>
</h3>
<p>The likelihood function of the mixture model cannot be maximized
analytically. However, if we knew the class membership of each
observation, the optimization problem would collapse to the independent
maximum likelihood estimation of two Gaussian distributions, which can
be solved analytically. This insight motivates the
expectation-maximization (EM) algorithm <span class="citation">(<a href="#ref-Dempster:1977">Dempster, Laird, and Rubin 1977</a>)</span>,
which iterates through the following steps:</p>
<ol style="list-style-type: decimal">
<li>Initialize
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛉</mi><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math>
and compute
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ell(\boldsymbol{\theta})</annotation></semantics></math>.</li>
<li>Calculate the posterior probabilities for each observation’s class
membership, conditional on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛉</mi><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math>.</li>
<li>Calculate the maximum likelihood estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛉</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\boldsymbol{\bar{\theta}}</annotation></semantics></math>
conditional on the posterior probabilities from step 2.</li>
<li>Evaluate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛉</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ell(\boldsymbol{\bar{\theta}})</annotation></semantics></math>
and either stop if the likelihood improvement
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛉</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ell(\boldsymbol{\bar{\theta}}) - \ell(\boldsymbol{\theta})</annotation></semantics></math>
is smaller than some threshold <code>epsilon</code> or if some iteration
limit <code>iterlim</code> is reached. Otherwise, return to step 2.</li>
</ol>
<p>The following function implements this algorithm:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span>, <span class="va">theta</span>, <span class="va">...</span>, <span class="va">epsilon</span> <span class="op">=</span> <span class="fl">1e-08</span>, <span class="va">iterlim</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">llk</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">theta</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">iterlim</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">class_1</span> <span class="op">&lt;-</span> <span class="va">lambda</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">mu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">sigma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">class_2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">lambda</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">mu</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">sigma</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">posterior</span> <span class="op">&lt;-</span> <span class="va">class_1</span> <span class="op">/</span> <span class="op">(</span><span class="va">class_1</span> <span class="op">+</span> <span class="va">class_2</span><span class="op">)</span></span>
<span>    <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span></span>
<span>    <span class="va">mu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">posterior</span> <span class="op">*</span> <span class="va">data</span><span class="op">)</span> <span class="op">/</span> <span class="va">lambda</span></span>
<span>    <span class="va">mu</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">-</span> <span class="va">lambda</span> <span class="op">*</span> <span class="va">mu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">lambda</span><span class="op">)</span></span>
<span>    <span class="va">sigma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">posterior</span> <span class="op">*</span> <span class="op">(</span><span class="va">data</span> <span class="op">-</span> <span class="va">mu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">lambda</span><span class="op">)</span></span>
<span>    <span class="va">sigma</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">posterior</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">data</span> <span class="op">-</span> <span class="va">mu</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">lambda</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">llk_old</span> <span class="op">&lt;-</span> <span class="va">llk</span></span>
<span>    <span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mu</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">qlogis</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">llk</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">theta</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">llk</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"em failed"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">llk</span> <span class="op">-</span> <span class="va">llk_old</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">epsilon</span><span class="op">)</span> <span class="kw">break</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"llk"</span> <span class="op">=</span> <span class="va">llk</span>, <span class="st">"estimate"</span> <span class="op">=</span> <span class="va">theta</span>, <span class="st">"iterations"</span> <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-optimizers-via-the-optimizer-framework">Defining optimizers via the <code>{optimizeR}</code> framework<a class="anchor" aria-label="anchor" href="#defining-optimizers-via-the-optimizer-framework"></a>
</h3>
<p>Previously, we integrated the <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">stats::nlm</a></code> and
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> optimizers into the <a href="https://loelschlaeger.de/optimizeR/" class="external-link">optimizeR</a>
framework using:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nlm</span> <span class="op">&lt;-</span> <span class="fu">optimizeR</span><span class="fu">::</span><span class="va"><a href="https://loelschlaeger.de/optimizeR/reference/Optimizer.html" class="external-link">Optimizer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>which <span class="op">=</span> <span class="st">"stats::nlm"</span><span class="op">)</span></span>
<span><span class="va">optim</span> <span class="op">&lt;-</span> <span class="fu">optimizeR</span><span class="fu">::</span><span class="va"><a href="https://loelschlaeger.de/optimizeR/reference/Optimizer.html" class="external-link">Optimizer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>which <span class="op">=</span> <span class="st">"stats::optim"</span><span class="op">)</span></span></code></pre></div>
<p>Employing the <a href="https://loelschlaeger.de/optimizeR/" class="external-link">optimizeR</a> framework is crucial for the
<a href="https://loelschlaeger.de/ino/">ino</a> package to maintain consistently named inputs and
outputs across different optimizers for interpretation purposes (which
is generally not the case).</p>
<p>The <a href="https://loelschlaeger.de/optimizeR/" class="external-link">optimizeR</a> package provides a dictionary of
optimizers that can be directly selected via the <code>which</code>
argument. For an overview of available optimizers, you can use:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">optimizeR</span><span class="fu">::</span><span class="va"><a href="https://loelschlaeger.de/optimizeR/reference/optimizer_dictionary.html" class="external-link">optimizer_dictionary</a></span></span>
<span><span class="co">#&gt; &lt;Dictionary&gt; optimization algorithms </span></span>
<span><span class="co">#&gt; Keys: </span></span>
<span><span class="co">#&gt; - lbfgsb3c::lbfgsb3c</span></span>
<span><span class="co">#&gt; - lbfgsb3c::lbfgsb3</span></span>
<span><span class="co">#&gt; - lbfgsb3c::lbfgsb3f</span></span>
<span><span class="co">#&gt; - lbfgsb3c::lbfgsb3x</span></span>
<span><span class="co">#&gt; - stats::nlm</span></span>
<span><span class="co">#&gt; - stats::nlminb</span></span>
<span><span class="co">#&gt; - stats::optim</span></span>
<span><span class="co">#&gt; - ucminf::ucminf</span></span></code></pre></div>
<p>However, any optimizer not contained in the dictionary can be
incorporated into the <a href="https://loelschlaeger.de/optimizeR/" class="external-link">optimizeR</a> framework by setting
<code>which = "custom"</code> first:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em_optimizer</span> <span class="op">&lt;-</span> <span class="fu">optimizeR</span><span class="fu">::</span><span class="va"><a href="https://loelschlaeger.de/optimizeR/reference/Optimizer.html" class="external-link">Optimizer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>which <span class="op">=</span> <span class="st">"custom"</span><span class="op">)</span></span></code></pre></div>
<p>… and then using the <code>definition()</code> method:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em_optimizer</span><span class="op">$</span><span class="fu">definition</span><span class="op">(</span></span>
<span>  algorithm <span class="op">=</span> <span class="va">em</span>,</span>
<span>  arg_objective <span class="op">=</span> <span class="st">"f"</span>,</span>
<span>  arg_initial <span class="op">=</span> <span class="st">"theta"</span>,</span>
<span>  out_value <span class="op">=</span> <span class="st">"llk"</span>,</span>
<span>  out_parameter <span class="op">=</span> <span class="st">"estimate"</span>,</span>
<span>  direction <span class="op">=</span> <span class="st">"max"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the expectation-maximization algorithm, an additional argument
<code>data</code> needs to be defined:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em_optimizer</span><span class="op">$</span><span class="fu">set_arguments</span><span class="op">(</span><span class="st">"data"</span> <span class="op">=</span> <span class="va">faithful</span><span class="op">$</span><span class="va">eruptions</span><span class="op">)</span></span></code></pre></div>
<p>For more details on the <a href="https://loelschlaeger.de/optimizeR/" class="external-link">optimizeR</a> package, please
refer to <a href="https://loelschlaeger.de/optimizeR/" class="external-link">the package
homepage</a>.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Bengtsson:2021" class="csl-entry">
Bengtsson, H. 2021. <span>“A Unifying Framework for Parallel and
Distributed Processing in <span>R</span> Using Futures.”</span> <em>The
R Journal</em> 13 (2): 208–27. <a href="https://doi.org/10.32614/RJ-2021-048" class="external-link">https://doi.org/10.32614/RJ-2021-048</a>.
</div>
<div id="ref-Bengtsson:2024" class="csl-entry">
———. 2024. <em>Progressr: An Inclusive, Unifying API for Progress
Updates</em>. <a href="https://CRAN.R-project.org/package=progressr" class="external-link">https://CRAN.R-project.org/package=progressr</a>.
</div>
<div id="ref-Bonnans:2006" class="csl-entry">
Bonnans, J.-F., J. C. Gilbert, C. Lemaréchal, and C. A. Sagastizábal.
2006. <em>Numerical Optimization: Theoretical and Practical
Aspects</em>. Springer Science &amp; Business Media.
</div>
<div id="ref-Chang:2025" class="csl-entry">
Chang, W. 2025. <em>R6: Encapsulated Classes with Reference
Semantics</em>. <a href="https://CRAN.R-project.org/package=R6" class="external-link">https://CRAN.R-project.org/package=R6</a>.
</div>
<div id="ref-Dempster:1977" class="csl-entry">
Dempster, A. P., N. M. Laird, and D. B. Rubin. 1977. <span>“Maximum
Likelihood from Incomplete Data via the EM Algorithm.”</span>
<em>Journal of the Royal Statistical Society: Series B</em> 39 (1):
1–22.
</div>
<div id="ref-Nelder:1965" class="csl-entry">
Nelder, J. A., and R. Mead. 1965. <span>“<span class="nocase">A Simplex
Method for Function Minimization</span>.”</span> <em>The Computer
Journal</em> 7 (4). <a href="https://doi.org/10.1093/comjnl/7.4.308" class="external-link">https://doi.org/10.1093/comjnl/7.4.308</a>.
</div>
<div id="ref-Nocedal:2006" class="csl-entry">
Nocedal, J., and S. J. Wright. 2006. <span>“Quadratic
Programming.”</span> <em>Numerical Optimization</em>, 448–92.
</div>
<div id="ref-Oelschlaeger:2025" class="csl-entry">
Oelschläger, L., and M. Ötting. 2025. <em>optimizeR: Unified Framework
for Numerical Optimizer</em>. <a href="https://CRAN.R-project.org/package=optimizeR" class="external-link">https://CRAN.R-project.org/package=optimizeR</a>.
</div>
<div id="ref-Schwendinger:2023" class="csl-entry">
Schwendinger, F., and H. W. Borchers. 2023. <span>“CRAN Task View:
Optimization and Mathematical Programming.”</span> <a href="https://CRAN.R-project.org/view=Optimization" class="external-link">https://CRAN.R-project.org/view=Optimization</a>.
</div>
<div id="ref-Shireman:2017" class="csl-entry">
Shireman, E., D. Steinley, and M. J. Brusco. 2017. <span>“Examining the
Effect of Initialization Strategies on the Performance of Gaussian
Mixture Modeling.”</span> <em>Behavior Research Methods</em> 49 (1):
282–93.
</div>
<div id="ref-Wickham:2019" class="csl-entry">
Wickham, H. 2019. <em>Advanced <span>R</span></em>. CRC press. <a href="https://doi.org/10.1201/9781351201315" class="external-link">https://doi.org/10.1201/9781351201315</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://loelschlaeger.de" class="external-link">Lennart Oelschläger</a>, <a href="https://www.uni-bielefeld.de/fakultaeten/wirtschaftswissenschaften/lehrbereiche/stats/team/marius-otting-(m.sc.)/" class="external-link">Marius Ötting</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
